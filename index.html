<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Swipe test WAC</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.lightbox_me.js"></script>
    
    <script type="text/javascript" src="js/swipe.js"></script>
    <script type="text/javascript" src="js/leaflet-src.js"></script>
    <script type="text/javascript" src="js/zoom_swipe.js"></script>
    <script type="text/javascript" src="js/flat_image_zoom.js"></script>
    <script type="text/javascript" src="js/jquery.actual.min.js"></script>
<link href="http://vjs.zencdn.net/c/video-js.css" rel="stylesheet">
<script src="http://vjs.zencdn.net/c/video.js"></script>
    <link type="text/css" rel="stylesheet" href="css/leaflet.css">
    <style>
        html {
            width: 100%;
            height:100%;
        }
        body {
            background-color: black;
            color: white;
            margin:0px;
            padding:0px;
            width: 100%;
            height:100%;
        }
        .swipe {
            overflow: hidden;
            visibility: hidden;
            position: relative;
            width:100%;
            height:100%;
        }
        .swipe-wrap {
          overflow: hidden;
          position: relative;
            width: 100%;
            height:100%;
        }
        .swipe-wrap div {
            float:left;
            position: relative;
        }
        .video {
          width: 80%;
          height:100%;
          margin: 0px auto;
          display:table;
        }
        .video div {
            float:none;
        }
        .centerVideo{
          display:table-cell;
          vertical-align:middle;
        }
        .zoomer {
            width:100%;
            height:100%;
            background-color: black;
        }
        
        nav{
          position:absolute;
          bottom:5px;
          right:5px;
        }
        video {
          max-width: 100%;
          height: auto;
        }
        .info{
          position:absolute !important;
          bottom:5px;
          left:5px;
          z-index:10000;
        }
        .info_btn{
          padding:5px;
          background:#FFF;
          margin:5px;
          color:#222;
        }
        .info_extended{
          height:300px;
          width:500px;
          background:white;
          color:black;
          display:none;
        }
        .info_title{
          display:block;
          color:#222;
        }
        .info_artist{
          display:block;
          color:#222;
        }
        .info_artist{
          display:block;
          color:#222;
        }
    </style>
</head>
<body>
    <div id='slider' class='swipe'>
      <div class='swipe-wrap'>
        <div class="image-view-1 zoomer">
          <div class="info">
            <div class="info_btn">
              <span class="info_title">Title</span>
              <span class="info_artist">Artist</span>
              <span class="info_artist">Year</span>
              MORE...
            </div>
            <div class="info_extended">
              image-view-1
            </div>
          </div>
        </div>
        <div class="image-view-2 zoomer">
          <div class="info">
            <div class="info_btn">
              <span class="info_title">Title</span>
              <span class="info_artist">Artist</span>
              <span class="info_artist">Year</span>
              MORE...
            </div>
            
            <div class="info_extended">
              image-view-2
            </div>
          </div>
        </div>
        <div id="video1" class="zoomer video">
          <div class="centerVideo">
            <video id="video1_player" class="video-js vjs-default-skin" controls preload="none"
  data-setup="{}" poster="http://video-js.zencoder.com/oceans-clip.jpg">
                <source src="http://video-js.zencoder.com/oceans-clip.mp4" type="video/mp4" />
            </video>
          </div>
          <div class="info">
            <div class="info_btn">
              <span class="info_title">Title</span>
              <span class="info_artist">Artist</span>
              <span class="info_artist">Year</span>
              MORE...
            </div>
            
            <div class="info_extended">
              video
            </div>
          </div>
        
        </div>
        <div class="image-view-3 zoomer">
          <div class="info">
            <div class="info_btn">
              <span class="info_title">Title</span>
              <span class="info_artist">Artist</span>
              <span class="info_artist">Year</span>
              MORE...
            </div>
            
            <div class="info_extended">
              image-view-3
            </div>
          </div>
        </div>
        <div class="image-view-4 zoomer">
          <div class="info">
            <div class="info_btn">
              <span class="info_title">Title</span>
              <span class="info_artist">Artist</span>
              <span class="info_artist">Year</span>
              MORE...
            </div>
            
            <div class="info_extended">
              image-view-4
            </div>
          </div>
        </div>
      </div>
    </div>
    <nav>
      <a href='#' id='prev' onclick='window.mySwipe.prev();return false;'><em>prev</em></a>
      <span id='position'><em class='on'>&bull;</em><em>&bull;</em><em>&bull;</em></span>
      <a href='#' id='next' onclick='window.mySwipe.next();return false;'><em>next</em></a>
    </nav>
    <script>
        var lastSlideId = "image-view-1";
		$(document).ready(function() {
      
      
      
          
            window.mySwipe = new Swipe(document.getElementById('slider'), {
                callback: function(index,slide) {
                    //console.log(slide.id)
                    if (Zoomer.zoomers[lastSlideId]) {
                        Zoomer.zoomers[lastSlideId].map.centerImageAtExtents();
                    }
                    var videoId = lastSlideId+"_player";
                    if ($('#'+videoId).length) {
                        var myPlayer = _V_(videoId);
                        if (myPlayer) {
                            myPlayer.pause();
                            //myPlayer.currentTime(0); // removes image? Maybe poster would help?
                        }
                    }
                    lastSlideId = slide.id; // record this so we know what we're leaving next time
                }
            });
            L.DomUtil.disableTextSelection();
            Zoomer.zoom_image_by_class({"container":"image-view-2", "tileURL": "https://stewart.walkerart.org/zoomtest/wac_786/{z}_{x}_{y}.jpg", "imageWidth": 4000, "imageHeight": 3187});
            Zoomer.zoom_image_by_class({"container":"image-view-1", "tileURL": "http://cdn{s}.walkerart.org/wac_786/{z}_{x}_{y}.jpg", "imageWidth": 4000, "imageHeight": 3187});
            //Zoomer.zoom_image_by_class({"container":"image-view-1", "tileURL": 'https://stewart.walkerart.org/zoomtest/wac_1729/{z}_{x}_{y}.jpg', "imageWidth": 2560, "imageHeight": 1702});
            Zoomer.zoom_image_by_class({"container":"image-view-3", "tileURL": "https://stewart.walkerart.org/zoomtest/wac_3691/{z}_{x}_{y}.jpg", "imageWidth": 1445, "imageHeight": 1920});
            Zoomer.zoom_image_by_class({"container":"image-view-4", "tileURL": "https://stewart.walkerart.org/zoomtest/wac_11156/{z}_{x}_{y}.jpg", "imageWidth": 5920, "imageHeight": 3893});
            
            _V_("video1_player").ready(function(){
              // Store the video object
              var myPlayer = this; 
              // Make up an aspect ratio
              var aspectRatio = 264/640; 
              
              function resizeVideoJS(){
                var width = document.getElementById(myPlayer.id).parentElement.offsetWidth;
                var w=window.innerWidth;
                if(width > w){
                  myPlayer.width(w).height( w * aspectRatio );
                }else{
                  myPlayer.width(width).height( width * aspectRatio );
                }
                
                
              }
               // Initialize resizeVideoJS()
              resizeVideoJS();
              // Then on resize call resizeVideoJS()
              
              var id;
              $(window).resize(function() {
                  clearTimeout(id);
                  id = setTimeout(resizeVideoJS, 100);
    
              });
              
              //window.onresize = resizeVideoJS; 
            });
            $('.info_btn').click(function(e) {
              e.preventDefault();
              e.stopPropagation();
              console.log($(this));
              $lightbx = $(this).parent().children(".info_extended").clone();
              $lightbx.lightbox_me({
                destroyOnClose:true
              });
            });

		});


    </script>
</body>
</html>
